{
    "resource": [
        {
            "azurerm_application_gateway": {
                "gw": {
                    "backend_address_pool": [
                        {
                            "name": "backendAddressPool"
                        }
                    ],
                    "backend_http_settings": [
                        {
                            "cookie_based_affinity": "Disabled",
                            "name": "backendHttpSettings",
                            "port": 80,
                            "protocol": "Http",
                            "request_timeout": 60
                        }
                    ],
                    "frontend_ip_configuration": [
                        {
                            "name": "appGatewayIPconfig",
                            "public_ip_address_id": "${azurerm_public_ip.pip.id}"
                        }
                    ],
                    "frontend_port": [
                        {
                            "name": "frontendPort",
                            "port": 80
                        }
                    ],
                    "gateway_ip_configuration": [
                        {
                            "name": "gw-ip-configuration",
                            "subnet_id": "${azurerm_subnet.frontend.id}"
                        }
                    ],
                    "http_listener": [
                        {
                            "frontend_ip_configuration_name": "appGatewayIPconfig",
                            "frontend_port_name": "frontendPort",
                            "name": "httpListener",
                            "protocol": "Http"
                        }
                    ],
                    "location": "${azurerm_resource_group.rg.location}",
                    "name": "lemoncodeAppgateway",
                    "request_routing_rule": [
                        {
                            "backend_address_pool_name": "backendAddressPool",
                            "backend_http_settings_name": "backendHttpSettings",
                            "http_listener_name": "httpListener",
                            "name": "requestRoutingRule",
                            "priority": 1000,
                            "rule_type": "Basic"
                        }
                    ],
                    "resource_group_name": "${azurerm_resource_group.rg.name}",
                    "sku": [
                        {
                            "capacity": 2,
                            "name": "Standard_v2",
                            "tier": "Standard_v2"
                        }
                    ]
                }
            }
        },
        {
            "azurerm_network_interface_application_gateway_backend_address_pool_association": {
                "nic-assoc1": {
                    "backend_address_pool_id": "${tolist(azurerm_application_gateway.gw.backend_address_pool)[0].id}",
                    "ip_configuration_name": "nic-ipconfig-1",
                    "network_interface_id": "${azurerm_network_interface.nic1.id}"
                }
            }
        },
        {
            "azurerm_network_interface_application_gateway_backend_address_pool_association": {
                "nic-assoc2": {
                    "backend_address_pool_id": "${tolist(azurerm_application_gateway.gw.backend_address_pool)[0].id}",
                    "ip_configuration_name": "nic-ipconfig-2",
                    "network_interface_id": "${azurerm_network_interface.nic2.id}"
                }
            }
        }
    ]
}